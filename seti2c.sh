#add device tree overlay to enable i2c1 (or 2, or whichever one the cape uses)
echo BB-I2C1 > /sys/devices/bone_capemgr.9/slots

#set mode to sleep
i2cset -y 2 0x40 0x00 0x11

#set frequency to 50Hz
i2cset -y 2 0x40 0xfe 121

#set mode to normal
i2cset -y 2 0x40 0x00 0x01

#set pwm 0-0 to 50% duty cycle, 0 offset
#i2cset -y 2 0x40 0x06 0x00
#i2cset -y 2 0x40 0x07 0x00
#i2cset -y 2 0x40 0x08 0x00
#i2cset -y 2 0x40 0x09 0x08

#set pwm 0-0 to 25% duty cycle, 0 offset
#i2cset -y 2 0x40 0x06 0x00
#i2cset -y 2 0x40 0x07 0x00
#i2cset -y 2 0x40 0x08 0x00
#i2cset -y 2 0x40 0x09 0x04

for i in 1 2 3 4 5 6 7 8 9 10
do
#set pwm 0-0 to 13.1% duty cycle (0 degrees at 50Hz), 0 offset
#i2cset -y 2 0x40 0x06 0x00
#i2cset -y 2 0x40 0x07 0x00
#i2cset -y 2 0x40 0x08 25
#i2cset -y 2 0x40 0x09 0x02

#120 degrees (9.69%)
#i2cset -y 2 0x40 0x06 0x00
#i2cset -y 2 0x40 0x07 0x00
#i2cset -y 2 0x40 0x08 140
#i2cset -y 2 0x40 0x09 0x01

#105 degrees (8.9%)
i2cset -y 2 0x40 0x06 0x00
i2cset -y 2 0x40 0x07 0x00
i2cset -y 2 0x40 0x08 108
i2cset -y 2 0x40 0x09 1

sleep 0.05

#set pwm 0-0 to 7.5% duty cycle (90 degrees at 50 Hz), 0 offset
#i2cset -y 2 0x40 0x06 0x00
#i2cset -y 2 0x40 0x07 0x00
#i2cset -y 2 0x40 0x08 51
#i2cset -y 2 0x40 0x09 0x01

#60 degrees (6.51%)
#i2cset -y 2 0x40 0x06 0x00
#i2cset -y 2 0x40 0x07 0x00
#i2cset -y 2 0x40 0x08 10
#i2cset -y 2 0x40 0x09 1

#75 degrees (7.3%)
i2cset -y 2 0x40 0x06 0x00
i2cset -y 2 0x40 0x07 0x00
i2cset -y 2 0x40 0x08 45
i2cset -y 2 0x40 0x09 1

#set pwm 0-0 to 3.7% duty cycle (180 degrees at 50Hz), 0 offset
#i2cset -y 2 0x40 0x06 0x00
#i2cset -y 2 0x40 0x07 0x00
#i2cset -y 2 0x40 0x08 175
#i2cset -y 2 0x40 0x09 0x00

sleep 0.05
done
